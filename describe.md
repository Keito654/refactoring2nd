# イキトメ!

---

## 概要

目の前に動くコードがあります。正常に動作はするものの、このまま機能を追加するのはちょっと厳しそうです。

今回は、実際の現場でよくある、そんな状況を想定し、TDD の一般的な進め方ではなく、 BDD のアプローチでモブプログラミングを進めてゆきます。

---

## FizzBuzz とは

1. 1 から順番に数字を表示するだけ
2. ただし、次の条件で置換する
    1. 3 の倍数なら Fizz
    2. 5 の倍数なら Buzz
    3. 両方の倍数なら FizzBuzz

(詳しくは Wikipedia の [Fizz Buzz](https://ja.wikipedia.org/wiki/Fizz_Buzz) で)

---

## シナリオ

前任者が FizzBuzz を実装しました。テストコードがあり、1 から 5 までは正しく動作することが分かってます。これを 100 まで動作する FizzBuzz に仕上げる仕事を上司から指示さまれました。

コードを見ると、そのまま拡張するのはちょっと難しそうです。リファクタリングの出番です。テストを失敗することなく、グリーンを維持したまま、コードを洗練してゆきましょう。

---

## 息止めルール

このセッションでは、テストが失敗してる間 (テストレッド) は、見ている人も全員息を止めるルールで進めてゆきます。ご協力をお願いします。

死人が出てしまわないよう、モブのドライバーは素早くテストが通る状態 (テストグリーン) に戻してください。

---

のケースについて、 FizzBuzz がの結果が出力されることを確認するテストコードを書きました。
テストコードは本番コードと同じ fizzbuzz.spec.jsに書いてあります。
ファイル一番下の、
   describe('FizzBuzz について', ....
のところです。

今回は、このテストコードはそのままにして、
テストが通過する状態(グリーン)を維持しながら、
コードを洗練していきます。
ただし、モブプログラミングで進めます。

※グリーンでなくなった瞬間、息止めルール(後述)が発動します。
　お楽しみに。

---

## モブプログラミング

チーム全体で、一つのモニタ、一つのキーボード、一つのコンピュータで作業をするワーキングスタイルです。作業者はドライバーで、
ほかのメンバーは全員ナビゲーターです。ドライバーはあたかも
コンピュータの拡張入力装置のようにふるまって、
周りのナビゲーターからの指示通りに入力していくように努めます。
ドライバーは数分ごとに交代します。

---

### BDDスタイルのテスト記述について
xUnitのテストコードに慣れた方は、このテストが assert 文でないことに
気が付かれたかと思います。describe, it という構文はBDD(ビヘイビア駆動開発)
のフォーマットです。BDDは、アプリケーションのあるべき振る舞いを
定義し、それをテストコードにして実行します。

describe (テストしたいふるまい)
  it should (あるべき出力など)
というような形式で記述していきます。
あるべき出力が得られなければ、テストはレッドになり、
「テストしたいふるまい」がパスしないことがわかります。

---

## ふりかえり

- 最初のコードと見比べましょう。
- リファクタリングとはなんだったのか話し合いましょう。
